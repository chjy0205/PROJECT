---
title: "R Notebook"
output:
  pdf_document: default
  html_notebook: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 
# Get demographic data from community report
```{r}
community=read.csv('https://github.com/chjy0205/data/raw/master/Community%20Reporting%20Areas.csv',stringsAsFactors = F)
```
# Verify data types
```{r}
str(community)
```
# Univariate data analysis
# Centrality
```{r}
summary(community$Median.household.income..dollars.)
```
# Dispersion
```{r}
library(moments)
sd(community$Median.household.income..dollars.,na.rm= T)
sd(community$Median.household.income..dollars.,na.rm =T)/mean(community$Median.household.income..dollars.,na.rm =T)
```
# Skewness
```{r}
skewness(community$Median.household.income..dollars.,na.rm=T)
```
# Kurtosis
```{r}
kurtosis(community$Median.household.income..dollars.,na.rm = T)

data=community[is.finite(community$Median.household.income..dollars.),]
var=data$Median.household.income..dollars.
mnVar=mean(var,na.rm = T)
sdVar=sd(var,na.rm = T)

library(ggplot2)

base=ggplot(data, aes(x=var))
hist = base + geom_histogram(fill="green", 
                             color='grey',
                          aes(y=..density..))
histAndNormal = hist + stat_function(fun=dnorm,
                                     color="red",
                                     args=list(mean=mnVar,sd=sdVar))

histAndNormal

```



# Linear Regression
### Check the data
```{r}
hist(community$Median.household.income..dollars.)
```
### Verify that each variable in X has a linear relationship with Y.
```{r}
explanans=names(community)[c(11,15)]
for (x in explanans){
    par=cbind(community[,x],community$Median.household.income..dollars.)
    p=cor.test(community[,x],community$Median.household.income..dollars.)
    print(paste("Pearson:",p$estimate," - Is significative?",p$p.value<0.05))
}
```
### Check the correlation between each pair of X variables.
```{r}
cor(community[explanans])
```
### Set the row names with the community names.
```{r}
row.names(community)=community$Community.Reporting.Area.Name
```
### Request a linear regression model and check the detailed result.
```{r}
LinRegINCOME=lm(community$Median.household.income..dollars.~ Percent.of.Population.of.Color + Percent.Bachelor.degree.or.higher, data = community)

summary(LinRegINCOME)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
